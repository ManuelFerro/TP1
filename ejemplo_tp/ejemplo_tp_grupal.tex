\documentclass[10pt,a4paper]{article}

\input{AEDmacros}
\usepackage{caratula} % Version modificada para usar las macros de algo1 de ~> https://github.com/bcardiff/dc-tex


\titulo{Trabajo práctico 1: Especificación y WP}
\subtitulo{Fondo monetario común}

\fecha{\today}

\materia{Algoritmos y Estructuras de Datos (ex-algo2)}
\grupo{Grupo --}

\integrante{Chiquinho, Santiago}{490/23}{santichiquinho@gmail.com}
\integrante{Brucellaria, Tomas}{287/23}{tomasbrus54@gmail.com}
\integrante{Caetano, Franco}{351/23}{francocaetano20@gmail.com}
\integrante{Ferro, Manuel}{405/23}{manu.ferro.13@gmail.com}
% Pongan cuantos integrantes quieran

% Declaramos donde van a estar las figuras
% No es obligatorio, pero suele ser comodo
\graphicspath{{../static/}}

\begin{document}

\maketitle

\section{Especificación}

\subsection{Problema 1:}

\begin{proc}{redistribucionDeLosFrutos:}
	{\In recursos : \TLista{\ent}\nat, \In cooperan : \TLista{\bool}}{\TLista{\ent}}

	\requiere{
		\longitud[recursos] = \longitud[cooperan] \yLuego

		todoPositivo[recursos]
	}
	\asegura{
		reparticiones[recursos, cooperan] \yLuego

		todoIgualSiCooperan[recursos, cooperan]
	}

	\pred{todoPositivo}{recursos}
	{\paraTodo[unalinea]{i}{\ent}{
		0 $\leq$ i $<$ \longitud[recursos] \implicaLuego recursos[i] $>$ 0
	}}

	\pred{reparticiones}{recursos, cooperan}
	{\paraTodo[unaLinea]{i}{\ent}{
		(0 $\leq$ i $<$ \longitud[recursos] \implicaLuego ((cooperan[i] = \True \yLuego res[i] = FMC(recursos, cooperan)) \oLuego (cooperan[i] = \False \yLuego res[i] = recursos[i] + FMC(recursos, cooperan))))}
	}

	\pred{todoIgualSiCooperan}{recursos, cooperan}
	{\paraTodo[unaLinea]{i,j}{\ent}{
		0 $\leq$ i,j $<$ \longitud[recursos] \yLuego cooperan[i] = cooperan[j] /implicaLuego recursos[i] = recursos[j]}
	}

	\aux{FMC}{recursos, cooperan}{\nat}
	{\paraTodo[unaLinea]{i}{\ent}{
		0 $\leq$ i $<$ \longitud[recursos] \implicaLuego ( res = (\sum\limits_{n=0}^-{\longitud[recursos] - 1} (if cooperan[i] = \True then recursos[i] else 0 fi) / (\longitud[cooperan] - 1)))}
	}

\end{proc}

\subsection{Problema 2:}

\begin{proc}{trayectoriaDeLosFrutosIndividualesALargoPlazo}
	{\Inout trayectorias: \TLista{\TLista{\float}}, \In cooperan: \TLista{\bool}, \In apuestas: \TLista{\TLista{\float}},
	 \In pagos: \TLista{\TLista{\float}}, \In eventos: \TLista{\TLista{\nat}}}

	\requiere{
		\longitud[trayectorias] = \longitud[cooperan] = \longitud[apuestas] = \longitud[pagos] = \longitud[eventos] \yLuego %chequeo si las listas trabajan el mismo grupo de individuos

		mismoGrupoDeEventos(apuestas, pagos) \yLuego %chequeo si ambas refieren al mismo grupo de posibles eventos

		igualCantidadDeEventosPorIndividuo(eventos) \yLuego %chequeo que cada individuo haya vivido la misma cantidad de eventos

		todoPositivo(apuestas, pagos) \yLuego %chequeo que todos los pagos sean positivos, igual que todas las apuestas

		todoElRecursoFueApostado(apuestas) \yLuego %chequeo que las apuestas sumadas sean el 100% de los recursos del individuo

		trayectoriasInicialesCorrectas(trayectorias) %chequeo que trayectorias esta en "estado incial", y que son todas positivas
		}
 
	\asegura{
		PagoApuestaCorrecto(trayectorias, apuestas, pagos, eventos) \yLuego
		PagoPozoCorrecto(trayectorias, cooperan) \yLuego
		\paraTodo[unalinea]{i}{\ent}{
			0 $\leq$ i $<$ \longitud[eventos] \implicaLuego \longitud[trayectorias[i]] = \longitud[eventos[i]] + 1
		 	%chequeo que al final cada trayectoria mida 1 más que la lista de eventos
		}}

	\pred{todoPositivo}{apuestas, pagos}
	{\paraTodo[unalinea]{i,j}{\ent}{
		(0 $\leq$ i $<$ \longitud[apuestas] \yLuego 0 $\leq$ j $<$ apuestas[i]) \implicaLuego (apuestas[i][j] $>$ 0 \yLuego pagos[i][j] $>$ 0)}
	}
	
	\pred{trayectoriasInicialesCorrectas}{trayectorias}
	{\paraTodo[unalinea]{i}{\ent}{
		(0 $\leq$ i $<$ \longitud[trayectorias]) \implicaLuego ((\longitud[trayectorias[i]] = 1) \yLuego ((\cab)[trayectorias[i]] $>$ 0))}
	} 
	
	\pred{PagoApuestaCorrecto}{trayectorias, apuestas, pagos, eventos}
		{\paraTodo[unalinea]{i,j}{\ent}{
			((0 $\leq$ i $<$ \longitud[trayectorias]) \yLuego (1 $\leq$ j $<$ \longitud[trayectorias[i]])) \implicaLuego %acomodo los índices
	 		(trayectorias[i][j] = trayectorias[i][j - 1]*apuestas[i][eventos[i][j - 1]]*pagos[i][eventos[i][j - 1]])
	 	}
		}%chequeo que el recurso del i-esimo jugador a tiempo j sea su anterior multiplicado por la apuesta y el pago que correspondan

	\pred{PagoPozoCorrecto}{trayectorias, cooperan}
		{\paraTodo[unalinea]{i,j}{\ent}{ ((0 $\leq$ i $<$ \longitud[trayectorias]) \yLuego (1 $\leq$ j $<$ \longitud[trayectorias[i]])) \implicaLuego
			\IfThenElse{cooperan[i] = True}
				{trayectorias[i][j] = redistribucionDeLosFrutos (recursosATiempoJ(trayectorias, j)[i], cooperan)[i]}
				{trayectorias[i][j] = redistribucionDeLosFrutos (recursosATiempoJ(trayectorias, j)[i], cooperan)[i] + trayectorias[i][j - 1]}
		}
		}%chequeo que el recurso del i-esimo jugador a tiempo j se corresponda con su pago del pozo

	\aux{recursosATiempoJ}{trayectorias, j}{\TLista{\float}}
	{\paraTodo[unalinea]{i}{\ent}{
		(0 $\leq$ i $<$ \longitud[trayectorias]) \implicaLuego 
		(res[i] = trayectorias[i][j]) 
	}}%arma una lista de los recursos de los jugadores a tiempo j

\end{proc}

\subsection{Problema 3:}

\begin{proc}{trayectoriaExtrañaEscalera:}{\In trayectoria : \TLista{\float}}{\bool}

	\requiere{\longitud[trayectoria] $\geq$ 3} %la función de longitud no printea bien, preguntar
	\asegura{\res = \True \Iff (( \exists ! i \in[1,\longitud[trayectoria]-2]): (trayectoria[i] > trayectoria [i-1] \yLuego trayectoria [i] > trayectoria [i+1] ))}
\end{proc}

\subsection{Problema 4:}

\begin{proc}{individuoDecideSiCooperarONo:}{\In individuo : \nat, \In recursos : \TLista{\ent} ,\Inout cooperan : \TLista{\bool}, \In apuestas : \TLista{\TLista{\ent}}, \In pagos : \TLista{\TLista{\ent}}, \In eventos : \TLista{\TLista{\ent}}}

	\requiere{
		(\longitud[recursos]=\longitud[cooperan]=\longitud[apuestas]=\longitud[pagos]=\longitud[eventos]) \yLuego (0 $leq$ individuo $<$ \longitud[cooperan]) \yLuego 
		((\paraTodo[unalinea]{i,j,k,l,m}{\ent}){((0 $\leq$ i $<$ \longitud[recursos] \implicaLuego recursos[i] $>$ 0) \yLuego (0 $\leq$ j,m $<$ \longitud[pagos] \implicaLuego pagos[j][m] $>$ 0) \yLuego (0 $\leq$ k,l $<$ \longitud[apuestas] \implicaLuego apuestas[k][l] $>$ 0))}) %ver como printea el () después del paratodo
		}
	\asegura{
		(evaluarRecursosIndividuo(individuo, apuestas, pagos, recursos, eventos) \yLuego ((\ifthenelse{(\exists i \in)}{evaluarDesertores(recursos, cooperan, apuestas, pagos, eventos)}{\skip}) \yLuego \ifthenelse{test}{evaluarCooperadores(recursos, cooperan, apuestas, pagos, eventos)}{\skip}) \implicaLuego evaluarCooperacion(individuo, recursos, cooperan, apuestas, pagos, eventos)) %preguntar la estructura el existe
		}

	\aux{evaluarRecursosIndividuo:}{\In individuo : \nat, \In recursos : \TLista{\ent} , \In apuestas : \TLista{\TLista{\ent}}, \In pagos : \TLista{\TLista{\ent}}, \In eventos : \TLista{\TLista{\ent}}}{\float}
		\requiere{
		(\paraTodo[unalinea]{i}{\ent}{0 $\leq$ i $<$ \longitud[recursos] \yLuego (\longitud[pagos[i]]==\longitud[apuestas[i]])})
		}
		\asegura{\paraTodo[unalinea]{j}{\ent}{((0 $\leq$ j $<$ \longitud[eventos[individuo]]) \implicaLuego (res = recursos[individuo] + apuestas[individuo][eventos[individuo][j]] * pagos[individuo][eventos[individuo][j]] - apuestas[individuo][eventos[individuo][j]]))} %¿res?
		}
	

	\aux{evaluarDesertores:}{\In recursos : \TLista{\float} ,\In cooperan : \TLista{\bool}, \In apuestas : \TLista{\TLista{\ent}}, \In pagos : \TLista{\TLista{\ent}}, \In eventos : \TLista{\TLista{\ent}}}{\float} 
		\requiere{True}

		\asegura{
			(\paraTodo[unalinea]{i}{\ent}{0 $\leq$ i $<$ \longitud[recursos] \yLuego cooperan[i]=False} \implicaLuego evaluarRecursosDesertores(i) \and  ((\sum\limits_{i=0}^{\longitud[recursos] - 1}[recursos][i])/(\sum\limits_{i=0}^{\longitud[cooperan] - 1}(\ifthenelse{cooperan[i]=False}{1}{0}))))
		}
		
		\aux{evaluarRecursosDesertores}{\Inout recursos : \TLista{\ent} ,\In cooperan : \TLista{\bool}, \In apuestas : \TLista{\TLista{\ent}}, \In pagos : \TLista{\TLista{\ent}}, \In eventos : \TLista{\TLista{\ent}}}
			\requiere{
				(\paraTodo[unalinea]{i}{\ent}{0 $\leq$ i $<$ \longitud[recursos] \yLuego (\longitud[pagos[i]]==\longitud[apuestas[i]])})
			}

				\asegura{
					(\paraTodo[unalinea]{i,j}{\ent}{(((0 $\leq$ i $<$ \longitud[cooperan] \yLuego cooperan[i]=False)\yLuego (0 $\leq$ j $<$ \longitud[eventos[i]])) \implicaLuego (recursos[i]= recursos[i] - apuestas[i][eventos[i][j]] + apuestas[i][eventos[i][j]]*pagos[i][eventos[i][j]]))})
				}

	\aux{evaluarCooperadores:}{\In recursos : \TLista{\float} ,\In cooperan : \TLista{\bool}, \In apuestas : \TLista{\TLista{\ent}}, \In pagos : \TLista{\TLista{\ent}}, \In eventos : \TLista{\TLista{\ent}}}{\float} 
		\requiere{True}

		\asegura{
			(\paraTodo[unalinea]{i}{\ent}{0 $\leq$ i $<$ \longitud[recursos] \yLuego cooperan[i]=True} \implicaLuego evaluarRecursosCooperadores(i) \and  ((\sum\limits_{i=0}^{\longitud[recursos] - 1}[recursos][i])/(\sum\limits_{i=0}^{\longitud[cooperan] - 1}(\ifthenelse{cooperan[i]=True}{1}{0}))))
		}
		
		\aux{evaluarRecursosCooperadores}{\Inout recursos : \TLista{\ent} ,\In cooperan : \TLista{\bool}, \In apuestas : \TLista{\TLista{\ent}}, \In pagos : \TLista{\TLista{\ent}}, \In eventos : \TLista{\TLista{\ent}}} %Recursos pasaría a ser una lista de float. Tengo/puedo cambiarlo en la especificación?
			\requiere{
				(\paraTodo[unalinea]{i}{\ent}{0 $\leq$ i $<$ \longitud[recursos] \yLuego (\longitud[pagos[i]]==\longitud[apuestas[i]])})
			}

			\asegura{
				(\paraTodo[unalinea]{i,j}{\ent}{(((0 $\leq$ i $<$ \longitud[cooperan] \yLuego cooperan[i]=True)\yLuego (0 $\leq$ j $<$ \longitud[eventos[i]])) \implicaLuego (recursos[i]= recursos[i] - apuestas[i][eventos[i][j]] + apuestas[i][eventos[i][j]]*pagos[i][eventos[i][j]]))})
			}
		
	\aux{evaluarCooperación}{\In individuo : \nat, \In recursos : \TLista{\ent} ,\Inout cooperan : \TLista{\bool}, \In apuestas : \TLista{\TLista{\ent}}, \In pagos : \TLista{\TLista{\ent}}, \In eventos : \TLista{\TLista{\ent}}}
		\requiere{True}

			\asegura{
				(((evaluarRecursosIndividuo $\leq$ evaluarDesertores \y evaluarDesertores $>$ evaluarCooperadores)\implicaLuego (cooperan[individuo]= False)) \oLuego ((evaluarRecursosIndividuo $\leq$ evaluarCooperadores \y evaluarCooperadores $>$ evaluarDesertores) \implicaLuego (cooperan[individuo]=True)) \oLuego ((evaluarDesertores == evaluarRecursosCooperadores) \implicaLuego cooperan[individuo] = cooperan[individuo]))
			}

\end{proc}

\subsection{Problema 5:}

\begin{proc}{individuoActualizaApuesta:}
	{\In individuo: \nat, \In recursos: \TLista{\float}, \In cooperan: \TLista{\bool}, \Inout apuestas: \TLista{\TLista{\float}},
	 \In pagos: \TLista{\TLista{\float}}, \In eventos: \TLista{\TLista{\nat}}}

	\requiere{
		\longitud[recursos] = \longitud[cooperan] = \longitud[apuestas] = \longitud[pagos] = \longitud[eventos] \yLuego

		mismoGrupoDeEventos(apuestas, pagos) \yLuego

		todoPositivo(recursos, apuestas, pagos) \yLuego

		todoElRecursoFueApostado(apuestas) \yLuego	

		0 $\leq$ individuo $<$ \longitud[apuestas]}
		
	\asegura{%¿habrá que chequear que solo cambió apuestas[individuo]? ¿cómo se haría eso?

		\longitud[apuestas] = \longitud[pagos] \yLuego %chequeo que la lista de apuestas conserve la longitud

		%la longitud podría chequearse con pagos, eventos, cooperan o recursos,
		%¿es correcto exigir que se chequee con pagos? sino,
		%¿habría que hacer un auxiliar para que se permita chequear la longitud con cualquiera? preguntar
		
		mismoGrupoDeEventos(apuestas, pagos) \yLuego %chequeo que todas las apuestas (en particular apuestas[individuo]) conserven la longitud

		todoPositivo(recursos, apuestas, pagos) \yLuego %reciclo el pred ya definido, pero este chequea la condición también en recursos y pagos,
														%¿es correcto? ¿o deberìa chequearse sólo apuestas?
		
		todoElRecursoFueApostado(apuestas) \yLuego %chequeo que todas las apuestas (en particular apuestas[individuo]) sigan sumando 1
		 
		RecursosFinales(individuo, recursos, apuestas, pagos, eventos) $\geq$ RecursosFinales(individuo, recursos, apuestas, pagos, eventos)
		%la idea es chequear que los recursos finales individuales que las nuevas apuestas generan sean "los máximos"
		%¿Cómo hacerlo?
		
		}%se supone que apuestas ya está modificado, sino es así preguntar cómo se indica eso

	\pred{todoPositivo}{recursos, apuestas, pagos}
	{\paraTodo[unalinea]{i,j}{\ent}{
		(0 $\leq$ i $<$ \longitud[apuestas] \yLuego 0 $\leq$ j $<$ apuestas[i]) \implicaLuego
		(apuestas[i][j] $>$ 0 \yLuego pagos[i][j] $>$ 0 \yLuego recursos[i] $>$ 0)}
	}

	\aux{RecursosFinales}{individuo, recursos, apuestas, pagos, eventos}{\float}
	{recursos[individuo]*(\prod_{n=0}^{\longitud[eventos[individuo]] - 1} [pagos][individuo][eventos[individuo][n]]*[apuestas][individuo][eventos[individuo][n]])}
	%una productoria que calcula todo el proceso multiplicativo

\end{proc}

\subsection{Auxiliares de Especificación:}

\aux{todoElRecursoFueApostado}{apuestas}{\ent}
	{\paraTodo[unalinea]{i,j}{\ent}{
		(0 $\leq$ i $<$ \longitud[apuestas] \yLuego 0 $\leq$ j $<$ apuestas[i]) \implicaLuego (\sum\limits_{n=0}^{j} [apuestas][i][n])}
	}

\pred{mismoGrupoDeEventos}{apuestas, pagos}
	{\paraTodo[unalinea]{i}{\ent}{
		0 $\leq$ i $<$ \longitud[pagos] \implicaLuego \longitud[apuestas][i] = \longitud[pagos][i]}
	}
\pred{igualCantidadDeEventosPorIndividuo}{eventos}
	{\paraTodo[unalinea]{i,j}{\ent}{
		0 $\leq$ i,j $<$ \longitud[eventos] \implicaLuego \longitud[eventos][i] = \longitud[eventos][j]}
	}

\section{Demostraciones de correctitud}
%demostrar que el programa frutoDelTrabajoPuramenteIndividual
%es correcto respecto de su espeficifación (en la consigna)
%Se hace con wp
\end{document}
